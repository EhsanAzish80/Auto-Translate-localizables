# GitHub Actions - Translation Automation (Phase 2)

This is a template for Phase 2. Copy to `.github/workflows/auto-translate.yml` when ready.

```yaml
name: Auto-Translate Localizations

on:
  # Trigger when English localization changes
  push:
    paths:
      - 'localization/en.xcloc/**'
      - '.xcloc/en.xcloc/**'
  
  # Allow manual triggering
  workflow_dispatch:
    inputs:
      languages:
        description: 'Languages to translate (space-separated, e.g., "de fr es")'
        required: false
        default: 'all'
      only_missing:
        description: 'Only translate missing strings'
        type: boolean
        required: false
        default: true

jobs:
  translate:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install auto-translate-localizables
        run: pip install auto-translate-localizables
      
      - name: Translate localization files
        run: |
          if [ "${{ github.event.inputs.languages }}" = "all" ]; then
            # Translate all languages except English
            auto-translate-xcloc \
              --workspace ./localization \
              --skip en \
              ${{ github.event.inputs.only_missing == 'true' && '--only-missing' || '' }} \
              --fail-on-placeholder-mismatch
          else
            # Translate specific languages
            auto-translate-xcloc \
              --workspace ./localization \
              --only ${{ github.event.inputs.languages }} \
              ${{ github.event.inputs.only_missing == 'true' && '--only-missing' || '' }} \
              --fail-on-placeholder-mismatch
          fi
      
      - name: Check for changes
        id: changes
        run: |
          if [ -n "$(git status --porcelain)" ]; then
            echo "has_changes=true" >> $GITHUB_OUTPUT
          else
            echo "has_changes=false" >> $GITHUB_OUTPUT
          fi
      
      - name: Create Pull Request
        if: steps.changes.outputs.has_changes == 'true'
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: |
            üåç Auto-translate localization files
            
            - Updated translations for modified strings
            - Validated placeholder preservation
            - Ready for review
          title: "üåç Update translations"
          body: |
            ## ü§ñ Automated Translation Update
            
            This PR was automatically generated by the translation workflow.
            
            ### What changed
            - Source: English localization files were updated
            - Action: Machine translation via Google Translate
            - Validation: All placeholders validated and preserved
            
            ### Review checklist
            - [ ] Review translated strings for accuracy
            - [ ] Check that placeholders are preserved correctly
            - [ ] Test in app to verify UI displays correctly
            - [ ] Consider having native speakers review key strings
            
            ### Quality note
            These are machine translations. Consider professional review for:
            - User-facing UI text
            - Marketing copy
            - Legal or compliance text
            - Brand-critical messaging
            
            ---
            Generated by [auto-translate-localizables](https://github.com/EhsanAzish80/Auto-Translate-localizables)
          branch: auto-translations-${{ github.run_number }}
          delete-branch: true
          labels: |
            localization
            automated
            needs-review
```

## Alternative: Direct Commit (No PR)

```yaml
name: Auto-Translate (Direct Commit)

on:
  push:
    paths:
      - 'localization/en.xcloc/**'

jobs:
  translate:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install translator
        run: pip install auto-translate-localizables
      
      - name: Translate
        run: |
          auto-translate-xcloc \
            --workspace ./localization \
            --only-missing \
            --fail-on-placeholder-mismatch
      
      - name: Commit changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add localization/
          git diff --quiet && git diff --staged --quiet || \
            git commit -m "üåç Auto-update translations"
          git push
```

## Setup Instructions

1. **Copy workflow file:**
   ```bash
   mkdir -p .github/workflows
   # Choose one of the YAML configs above and save to:
   # .github/workflows/auto-translate.yml
   ```

2. **Adjust paths:**
   - Replace `localization/` with your actual workspace path
   - Update `en.xcloc` path to match your structure

3. **Commit and push:**
   ```bash
   git add .github/workflows/auto-translate.yml
   git commit -m "ci: Add auto-translation workflow"
   git push
   ```

4. **Test it:**
   - Make a change to `en.xcloc` files
   - Push to GitHub
   - Watch the Actions tab for the workflow run

## What This Gives You

‚úÖ **Automatic translations** when English changes  
‚úÖ **Manual trigger** via GitHub UI for on-demand translation  
‚úÖ **Pull Request workflow** for review before merge  
‚úÖ **Validation** ensures placeholder safety  
‚úÖ **Configurable** language selection and modes  
‚úÖ **Professional CI setup** shows DevOps expertise  

## Cost Considerations

GitHub Actions minutes:
- Free tier: 2,000 minutes/month (sufficient for most projects)
- Typical run: 2-5 minutes per workflow
- Translation happens outside GitHub (Google Translate API is free)

## Next Level: Scheduled Updates

```yaml
on:
  schedule:
    # Run every Monday at 9am UTC
    - cron: '0 9 * * 1'
```

This would automatically check for untranslated strings weekly.
